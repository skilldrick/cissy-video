<!doctype HTML>
<html>
  <head>
    <title>!!!</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script>
      $(document).ready(function () {
        window.audio = $('audio')[0];
        audio.addEventListener('canplay', function () {
          console.log(audio.duration);
          audio.play();
        }, false);
        var i = 0;
        var lastTime = 0;

        var start = 2.9;
        var bpm = 180;
        var beats = 4;
        var slice = (beats * 60) / bpm;

        var timeA = start;
        var timeB = start + slice * 1;
        var timeC = start + slice * 2;
        var timeD = start + slice * 3;

        audio.addEventListener('timeupdate', function () {
          var time;
          for (var i = 0; i < 120; i++) {
            time = start + slice * i;
            if (lastTime <= time && this.currentTime > time) {
              (i % 2 == 0) ? $('img').show() : $('img').hide();
            }
          }
          lastTime = this.currentTime;
          console.log(this.currentTime);
        }, false);
      });
    </script>
  </head>
  <body>
    <audio preload="auto" src="cissy.wav" controls type='audio/x-wav'></audio>
    <br />
    <img src="http://i.imgur.com/94Apv.gif" style="display: none" />
  </body>
</html>
